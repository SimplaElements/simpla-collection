<link rel="import" href="../polymer/polymer.html"> <link rel="import" href="../simpla-element-behavior/simpla-element-behavior.html"> <dom-module id="simpla-collection"> <template> <style>*,::after,::before,:host{box-sizing:border-box}:host{display:block;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-smoothing:antialiased}.wrapper{position:relative;min-height:100px}.edit{@apply --simpla-button;display:flex;position:absolute;top:.5em;left:.5em;align-items:center;background:var(--simpla-grey-700);color:#fff;z-index:var(--simpla-on-top);opacity:0}:host(:hover) .edit{opacity:1}.edit::before{@apply --simpla-button-highlight}.edit:active::before{@apply --simpla-button-highlight-active}.edit__icon{--iron-icon-width:1em;--iron-icon-height:1em;margin-right:.5em}.placeholder{position:absolute;display:flex;top:0;left:0;align-items:center;justify-content:center;width:100%;height:100%;background:var(--simpla-grey-100);cursor:pointer}.placeholder__label{@apply --simpla-button;display:flex;align-items:center;border-radius:999px;padding-left:1.25em;padding-right:1.25em;background:var(--simpla-grey-300);color:var(--simpla-grey-700)}.placeholder__label__icon{--iron-icon-width:1.1em;--iron-icon-height:1.1em;margin-right:.3em}[hidden]{display:none!important}</style> <simpla-collection-editor items="{{items}}" as="[[as]]" active="{{active}}"> </simpla-collection-editor> <div class="wrapper"> <template is="dom-if" if="[[editable]]"> <button class="edit" on-tap="_edit" hidden$="[[_hideEdit(items.*, active)]]"> <iron-icon class="edit__icon" icon="simpla-collection:mode-edit"> </iron-icon> [[as]]s </button> <div class="placeholder" on-tap="add" hidden$="[[!_showPlaceholder(items.*)]]"> <div class="placeholder__label"> <iron-icon class="placeholder__label__icon" icon="simpla-collection:add"> </iron-icon> add [[as]] </div> </div> </template> <slot></slot> </div> </template> <script>!function(){"use strict";function t(){return Math.random().toString(36).substr(-4)}var e="simpla-collection-editor.html";Polymer({is:"simpla-collection",properties:{items:{type:Array,value:[]},as:{type:String,value:"item"},active:{type:Boolean,notify:!0,value:!1},editable:{type:Boolean,observer:"_importEditor",notify:!0,value:!1}},observers:["_render(items.*)"],behaviors:[SimplaBehaviors.Element],created:function(){this.setupSimpla({type:"Collection",dataProperties:["items"]})},add:function(){this.push("items",t())},remove:function(t){var e=this.path+"/"+t,i=(this.items.find(t),this.items.indexOf(t));Simpla.remove(e),this.splice("items",i,1)},swap:function(t,e){var i=this.items,r=i.slice(),o=i.indexOf(t),n=i.indexOf(e);r[n]=i[o],r[o]=i[n],this.items=r},_render:function(){for(var t=this,e=Polymer.dom(this).querySelector("template"),i=this.items,r=function(e,i){var r=["path","sid","gid"];r.forEach(function(r){Array.prototype.forEach.call(e.querySelectorAll("["+r+"]"),function(e){var o=e.getAttribute(r);e.setAttribute(r,o.replace("["+t.as+"]",i))})})};this.children.length>1;)Polymer.dom(this).removeChild(this.children[1]);i.forEach(function(i,o){var n=document.importNode(e.content,!0);r(n,i),Polymer.dom(t).appendChild(n)})},_edit:function(){this.active=!0},_importEditor:function(t){t&&this.importHref(this.resolveUrl(e))},_showPlaceholder:function(t){return 0===t.value.length},_hideEdit:function(t,e){return 0===t.value.length||e}})}(); </script> </dom-module> 